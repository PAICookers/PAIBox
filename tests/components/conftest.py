from tests.conftest import ParametrizedTestData

conv2d_semifolded_fc_chainnet_data = ParametrizedTestData(
    args="ishape_chw, n_conv, kshape_oihw, stride, padding, out_features, groups",
    data=[
        # n_conv = 1
        (
            (3, 11, 11),
            1,
            [(1, 3, 3, 3)],
            [1],
            [1],
            (10,),
            [1],
        ),
        (
            (3, 12, 12),
            1,
            [(12, 3, 3, 3)],
            [(1, 1)],
            [2],
            (10,),
            [1],
        ),
        (
            (8, 12, 12),
            1,
            [(16, 8, 3, 3)],
            [(2, 2)],
            [2],
            (10,),
            [1],
        ),
        (
            (8, 12, 12),
            1,
            [(16, 8, 4, 4)],
            [2],
            [1],
            (10,),
            [1],
        ),
        (
            (4, 12, 12),
            1,
            [(8, 4, 3, 3)],
            [1],
            [0],
            (4, 2),
            [1],
        ),
        (
            (4, 24, 24),
            1,
            [(8, 4, 3, 3)],
            [2],
            [0],
            10,
            [1],
        ),
        (
            (12, 12, 12),
            1,
            [(6, 12, 3, 3)],
            [1],
            [0],
            (3, 3),
            [1],
        ),
        (
            (4, 24, 24),
            1,
            [(8, 4, 4, 4)],
            [2],
            [0],
            (10,),
            [1],
        ),
        (
            (8, 32, 32),
            1,
            [(4, 8, 3, 3)],
            [2],
            [0],
            10,
            [1],
        ),
        # group
        (
            (8, 32, 32),
            1,
            [(4, 4, 3, 3)],
            [2],
            [0],
            10,
            [2],
        ),
        (
            (8, 32, 32),
            1,
            [(8, 1, 3, 3)],
            [2],
            [0],
            10,
            [8],
        ),
        # n_conv = 2
        ## group
        (
            (4, 5, 5),
            2,
            [(8, 1, 3, 3), (8, 1, 3, 3)],
            [(1, 1), (1, 1)],
            [2, 2],
            10,
            [4, 8],
        ),
        (
            (4, 32, 32),
            2,
            [(8, 2, 3, 3), (12, 4, 4, 4)],
            [(2, 2), (2, 2)],
            [1, 1],
            10,
            [2, 2],
        ),
        ##
        (
            (1, 5, 5),
            2,
            [(1, 1, 3, 3), (1, 1, 3, 3)],
            [(1, 1), (1, 1)],
            [2, 2],
            10,
            [1, 1],
        ),
        (
            (4, 32, 32),
            2,
            [(8, 4, 3, 3), (12, 8, 4, 4)],
            [(2, 2), (2, 2)],
            [1, 1],
            10,
            [1, 1],
        ),
        (
            (4, 32, 32),
            2,
            [(8, 4, 3, 3), (12, 8, 4, 4)],
            [(2, 2), (1, 1)],
            [1, 2],
            10,
            [1, 1],
        ),
        ((1, 32, 32), 2, [(1, 1, 3, 3), (1, 1, 3, 3)], [2, 2], [2, 2], 10, [1, 1]),
        ((1, 32, 32), 2, [(1, 1, 4, 4), (1, 1, 4, 4)], [1, 2], [2, 2], 10, [1, 1]),
        ((1, 32, 32), 2, [(1, 1, 4, 4), (1, 1, 4, 4)], [2, 2], [2, 2], 10, [1, 1]),
        ((1, 24, 24), 2, [(1, 1, 3, 3), (1, 1, 4, 4)], [1, 2], [2, 1], 10, [1, 1]),
        ((1, 24, 24), 2, [(1, 1, 3, 3), (1, 1, 3, 3)], [2, 2], [2, 2], 10, [1, 1]),
        # n_conv = 3
        ## group
        (
            (4, 32, 32),
            3,
            [(8, 1, 3, 3), (8, 1, 3, 3), (4, 2, 2, 2)],
            [1, 1, 1],
            [1, 1, 1],
            3,
            [4, 8, 4],
        ),
        ##
        (
            (4, 32, 32),
            3,
            [(8, 4, 3, 3), (16, 8, 3, 3), (8, 16, 2, 2)],
            [1, 1, 1],
            [1, 1, 1],
            3,
            [1, 1, 1],
        ),
        (
            (3, 32, 32),
            3,
            [(16, 3, 3, 3), (32, 16, 3, 3), (10, 32, 3, 3)],
            [1, 1, 1],
            [1, 0, 1],
            10,
            [1, 1, 1],
        ),
        (
            (1, 224, 224),
            3,
            [(1, 1, 7, 7), (1, 1, 5, 5), (1, 1, 3, 3)],
            [2, 2, 2],
            [3, 2, 1],
            10,
            [1, 1, 1],
        ),
        (
            (3, 32, 32),
            3,
            [(3, 3, 3, 3), (3, 3, 2, 2), (3, 3, 3, 3)],
            [1, 2, 1],
            [1, 0, 1],
            10,
            [1, 1, 1],
        ),
        # n_conv = 5
        (
            (3, 32, 32),
            5,
            [(3, 3, 3, 3), (3, 3, 2, 2), (3, 3, 3, 3), (3, 3, 2, 2), (3, 3, 3, 3)],
            [1, 2, 1, 2, 1],
            [1, 0, 1, 0, 1],
            10,
            [1, 1, 1, 1, 1],
        ),
    ],
)


pool2d_semifolded_fc_chainnet_data = ParametrizedTestData(
    args="ishape_chw, n_pool, kshape_hw, stride, padding, out_features, pool_type",
    data=[
        # n_pool = 1
        ((3, 16, 16), 1, [2], [2], [1], (10,), "avg"),
        # n_pool = 2
        ((3, 24, 24), 2, [2, 2], [1, 1], [0, 0], (2, 2), "avg"),
        (
            (3, 24, 24),
            2,
            [(2, 2), (2, 2)],
            [None, None],
            [1, 1],
            (10,),
            "avg",
        ),
        ((4, 32, 32), 2, [3, 3], [1, 1], [(0, 0), (1, 1)], (10,), "avg"),
        ((1, 8, 8), 2, [3, 3], [1, 1], [(0, 0), (1, 1)], (10,), "avg"),
        ((3, 24, 24), 2, [2, 2], [1, 1], [], (4,), "max"),
        ((3, 24, 24), 2, [(2, 2), (2, 2)], [2, 2], [], (10,), "max"),
        ((6, 32, 32), 2, [3, 3], [None, None], [], (10,), "max"),
        # n_pool = 3
        (
            (3, 48, 48),
            3,
            [3, 2, 2],
            [None, None, None],
            [(1, 1), (0, 0), (1, 1)],
            (10,),
            "avg",
        ),
        (
            (3, 48, 48),
            3,
            [3, 3, 3],
            [2, 2, 2],
            [(2, 2), (0, 0), (1, 1)],
            (10,),
            "avg",
        ),
        ((3, 48, 48), 3, [3, 2, 2], [None, None, None], [], (10,), "max"),
    ],
)


ann_pool1d_data = ParametrizedTestData(
    args="ishape_cl, n_pool, kshape_l, stride, padding, out_features, pool_type",
    data=[
        # n_pool = 1
        ((1, 8), 1, [2], [2], [1], (10,), "max"),
        ((3, 16), 1, [2], [2], [1], (10,), "avg"),
        # n_pool = 2
        ((1, 8), 2, [2, 2], [2, 2], [0, 0], (2,), "max"),
        ((3, 24), 2, [2, 2], [None, None], [0, 0], (10,), "avg"),
        ((3, 24), 2, [2, 2], [1, 1], [0, 0], (4,), "max"),
        ((6, 32), 2, [3, 3], [None, None], [1, 1], (10,), "max"),
    ],
)

ann_pool2d_data = ParametrizedTestData(
    args="ishape_chw, n_pool, kshape_hw, stride, padding, out_features, pool_type",
    data=[
        # n_pool = 1
        ((1, 8, 8), 1, [2], [2], [1], (10,), "max"),
        ((3, 16, 16), 1, [2], [2], [1], (10,), "avg"),
        # n_pool = 2
        ((1, 8, 8), 2, [2, 2], [2, 2], [0, 0], (2, 2), "max"),
        ((3, 24, 24), 2, [(2, 2), (2, 2)], [None, None], [0, 0], (10,), "avg"),
        ((3, 24, 24), 2, [2, 2], [1, 1], [(0, 0), (1, 1)], (4,), "max"),
        ((3, 24, 24), 2, [(2, 2), (2, 2)], [2, 2], [(1, 1), 0], (10,), "max"),
        ((6, 32, 32), 2, [3, 3], [None, None], [2, 2], (10,), "max"),
    ],
)
